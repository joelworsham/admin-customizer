Array.prototype.move=function(a,b){if(b>=this.length)for(var c=b-this.length;c--+1;)this.push(void 0);return this.splice(b,0,this.splice(a,1)[0]),this};var AC_Interface;!function(a,b){"use strict";function c(){d.init()}var d=AC_Interface={$elements:[],active_menu:!1,dash_widgets:[],current_role:null,cover_timer:0,unsaved_changes:!1,init:function(){d.get_elements(),d.setup_handlers(),d.launch_interface()},get_elements:function(){d.$elements.adminmenu=a("#adminmenu"),d.$elements.toolbar=a("#wpadminbar"),d.$elements.adminmenu_trash=a(".ac-interface-adminmenu-trash"),d.$elements.widgets_toolbar=a("#ac-interface-widgets-toolbar"),d.$elements.widgets_trash=d.$elements.widgets_toolbar.find(".ac-interface-widgets-trash"),d.$elements.widgets_new=d.$elements.widgets_toolbar.find(".ac-interface-widgets-new"),d.$elements.dashwidgets=a("#dashboard-widgets").find(".meta-box-sortables"),d.$elements.widget_move_adminnotice=a("#ac-widgets-move-adminnotice"),d.$elements.toolbar=a("#ac-interface-toolbar"),d.$elements.cover=a("#ac-interface-cover"),d.$elements.save=d.$elements.toolbar.find("[data-ac-interface-save]"),d.$elements.reset=d.$elements.toolbar.find("[data-ac-interface-reset]"),d.$elements.exit=d.$elements.toolbar.find("[data-ac-interface-exit]"),d.$elements.select_role=d.$elements.toolbar.find("[data-ac-interface-select-role]")},setup_handlers:function(){d.$elements.save.click(d.save_interface),d.$elements.exit.click(d.exit_interface),d.$elements.reset.click(d.reset_interface),d.$elements.select_role.change(d.change_role),d.$elements.dashwidgets.on("click","[data-ac-edit]",d.open_edit_widget),d.$elements.dashwidgets.on("click","[data-ac-cancel]",d.cancel_edit_widget),d.$elements.dashwidgets.on("click","[data-ac-save]",d.save_edit_widget),d.$elements.dashwidgets.on("click",'h2.hndle input[type="text"]',function(b){a(this).closest(".postbox").removeClass("closed")}),d.$elements.dashwidgets.on("sortstop",d.show_widget_move_adminnotice)},launch_interface:function(){function c(){d.unsaved_changes=!0}function e(a,b){d.unsaved_changes=!0,d.$elements.adminmenu_trash.removeClass("empty")}function f(a,b){d.unsaved_changes=!0,d.$elements.adminmenu_trash.find("> li").length||d.$elements.adminmenu_trash.addClass("empty")}function g(a,c){var e=c.item.filter('[id^="ac-widget-"]').length?b.interfaceL10n.widgetsTrashPostfixAC:b.interfaceL10n.widgetsTrashPostfixWP;d.unsaved_changes=!0,c.item.addClass("closed"),c.item.find("h2.hndle").append('<span class="ac-interface-widget-trashed-postfix"> '+e+"</span>"),d.$elements.widgets_trash.removeClass("empty"),c.sender.find(".postbox").length||(c.sender.addClass("empty-container"),c.sender.attr("data-emptyString",postBoxL10n.postBoxEmptyString))}function h(a,b){var c=d.dash_widgets[b.item.attr("id")];d.unsaved_changes=!0,c&&delete c.trashed,b.item.removeClass("closed"),b.item.find(".ac-interface-widget-trashed-postfix").remove(),d.$elements.widgets_trash.find("> .postbox").length||(d.$elements.widgets_trash.addClass("empty"),d.$elements.widgets_trash.attr("data-emptyString",postBoxL10n.postBoxEmptyString))}function i(a,b){b.placeholder.height(b.helper.find(".hndle").outerHeight()),b.helper.addClass("closed").height(b.helper.find(".hndle").outerHeight())}function j(a,b){b.helper&&b.helper.removeClass("closed").height("auto").width(d.$elements.dashwidgets.width())}function k(c,e){var f,g,h,i=e.item,j=i.find(".ac-widget-form"),k={};d.unsaved_changes=!0,j.length&&a.each(j.serializeArray(),function(a,b){k[b.name]=b.value}),k.title=i.find('[name="ac_widget_title"]').val(),k.title||(k.title=i.find(".ac-widget-title-text").html()),d.reveal_cover(),j.find("input:text, input:password, input:file, select, textarea").val(""),j.find("input:radio, input:checkbox").removeAttr("checked").removeAttr("selected"),i.find('[name="ac_widget_title"]').val(""),i.addClass("closed"),h=i.clone(!0),d.$elements.widgets_new.append(h),d.$elements.widgets_new.sortable("refresh"),f=d.$elements.dashwidgets.find('[id^="'+i.attr("id")+'"]').length-1,i.find(".inside").html(""),i.find(".ac-widget-title-text").html(k.title?k.title:k.widget_name),i.find(".ac-widget-title-input").remove(),i.find("h2.hndle").append(a("#ac-interface-widget-edit-actions").html()),i.removeClass("closed"),i.attr("id",g=i.attr("id")+"_"+f),k.id=g,d.dash_widgets[g]=k,postboxes.save_order("dashboard"),a.post(ajaxurl,{action:"ac-get-widget-html",widget:k,output:"widget",ac_nonce:b.nonce},function(a){switch(a.status){case"success":i.find(".inside").html(a.output);break;case"fail":alert(a.error_msg);break;default:alert("Could not complete for unknown reasons.")}d.hide_cover()})}d.current_role=b.current_role,a("#closedpostboxesnonce").val("disabled").before("<!-- Disabled by Admin Customizer Sandbox for the Interface page. @see assets/src/js/interface.js api.launch_interface() for more information. -->"),a("#meta-box-order-nonce").val("disabled"),d.$elements.adminmenu.find("li, a").removeClass("wp-has-current-submenu current").addClass("wp-not-current-submenu").attr("data-ac-menu-item-open","1"),a("#collapse-menu").remove(),d.active_menu=b.current_menu,d.$elements.adminmenu.find("> li").each(function(){var b=a(this).index(),c=d.active_menu[b],e=a(this).find(".wp-submenu");a(this).data("ac_active_menu_item",c),d.active_menu[b].$item=a(this),e.length&&e.find("> li").each(function(){var c,e=a(this).index();return 0===e?!0:(e-=1,c=d.active_menu[b].submenu[e],a(this).data("ac_active_submenu_item",c),void(d.active_menu[b].submenu[e].$item=a(this)))})}),d.$elements.adminmenu.find("> li").each(function(){d.active_menu[a(this).index()].remove&&a(this).appendTo(d.$elements.adminmenu_trash)}),d.$elements.adminmenu.sortable({placeholder:"ui-sortable-placeholder",axis:"y",appendTo:"parent",connectWith:".ac-interface-adminmenu-trash",change:c}).on("click","a",d.disable_anchor).find(".wp-submenu").sortable({placeholder:"ui-sortable-placeholder",axis:"y"}),d.$elements.adminmenu_trash.sortable({placeholder:"ui-sortable-placeholder",axis:"y",connectWith:"#adminmenu",receive:e,remove:f}),d.$elements.adminmenu_trash.find("> li").length||(d.$elements.adminmenu_trash.addClass("empty"),d.$elements.adminmenu_trash.attr("data-emptyString",b.interfaceL10n.adminmenuTrashEmpty)),d.$elements.widgets_toolbar.insertBefore("#dashboard-widgets-wrap"),d.dash_widgets=b.dash_widgets,d.$elements.dashwidgets.find("h2.hndle").append(a("#ac-interface-widget-edit-actions").html()),d.dash_widgets&&a.each(d.dash_widgets,function(c,e){var f;return e.trashed?(f=a("#"+c),void(f.length&&f.addClass("closed").appendTo(d.$elements.widgets_trash).find("h2.hndle").append('<span class="ac-interface-widget-trashed-postfix"> '+b.interfaceL10n.widgetsTrashPostfixWP+"</span>"))):!0}),d.$elements.widgets_trash.sortable({containment:!1,connectWith:".meta-box-sortables",placeholder:"sortable-placeholder",receive:g,remove:h,over:i,out:j}),d.$elements.widgets_trash.find("> .postbox").length||(d.$elements.widgets_trash.addClass("empty"),d.$elements.widgets_trash.attr("data-emptyString",postBoxL10n.postBoxEmptyString)),d.$elements.widgets_trash.on("click",".hndle",function(b){a(this).closest(".postbox").addClass("closed")}),d.$elements.dashwidgets.sortable("option","connectWith",d.$elements.dashwidgets.sortable("option","connectWith")+", .ac-interface-widgets-trash"),d.$elements.widgets_new.find(".meta-box-sortables").removeClass("meta-box-sortables"),d.$elements.widgets_new.sortable({connectWith:".meta-box-sortables",placeholder:"sortable-placeholder",stop:k}),d.$elements.widgets_new.find('h2.hndle input[name$="_title"]').click(function(a){a.stopPropagation()})},open_edit_widget:function(){function c(){d.$elements.cover.addClass("ac-widget-editing"),h.addClass("ac-widget-placeholder"),a("html, body").animate({scrollTop:h.offset().top-(d.$elements.toolbar.length?d.$elements.toolbar.height():0)})}var e,f,g=a(this).closest(".postbox"),h=g.clone(!0).removeAttr("id"),i=d.dash_widgets[g.attr("id")];g.hide().after(h),h.removeClass("closed").attr("data-id",g.attr("id")),h.find("[data-ac-edit]").hide(),h.find("[data-ac-save], [data-ac-cancel]").show(),d.reveal_cover(),e=a("<div>"+i.title+"</div>"),e.find(".hide-if-no-js").length?(f=e.find(".hide-if-no-js").html(),i["no-js-title"]=e.find(".hide-if-js").html()):f=i.title,h.find("h2.hndle span").first().html('<input type="text" value="'+f+'" />'),i.ac_id?a.post(ajaxurl,{action:"ac-get-widget-html",widget:i,output:"form",ac_nonce:b.nonce},function(a){switch(a.status){case"success":h.find(".inside").html(a.output);break;case"fail":alert(a.error_msg);break;default:alert("Could not complete for unknown reasons.")}c()}):c()},save_edit_widget:function(){var c=a(this).closest(".postbox"),e=a("#"+c.attr("data-id")),f=c.find(".ac-widget-form"),g=d.dash_widgets[e.attr("id")];d.unsaved_changes=!0,g.title=c.find('h2.hndle input[type="text"]').val(),g["no-js-title"]&&(g.title='<span class="hide-if-no-js">'+g.title+'</span><span class="hide-if-js">'+g["no-js-title"]+"</span>"),f.length&&a.each(f.serializeArray(),function(a,b){g[b.name]=b.value}),d.$elements.cover.removeClass("ac-widget-editing"),d.reveal_cover(),e.find("h2.hndle span").first().html(g.title),g.ac_id?a.post(ajaxurl,{action:"ac-get-widget-html",widget:g,output:"widget",ac_nonce:b.nonce},function(a){switch(a.status){case"success":e.find(".inside").html(a.output);break;case"fail":alert(a.error_msg);break;default:alert("Could not complete for unknown reasons.")}d.hide_cover()}):d.hide_cover(),e.removeClass("closed").show(),c.remove(),a(this).hide(),a(this).siblings("[data-ac-edit]").show(),a(this).siblings("[data-ac-cancel]").hide()},cancel_edit_widget:function(){var b=a(this).closest(".postbox"),c=a("#"+b.attr("data-id"));c.removeClass("closed").show(),b.remove(),d.hide_cover()},save_interface:function(){var c,e,f,g,h,i,j=[];for(d.unsaved_changes=!1,c=0;c<d.active_menu.length;c++){if(e={slug:d.active_menu[c].slug,submenu:!1},h=d.active_menu[c].$item.closest(".ac-interface-adminmenu-trash").length>0,h?(e.position=d.active_menu[c].$item.index()+d.$elements.adminmenu.find("> li").length,e.remove=!0):(e.position=d.active_menu[c].$item.index(),e.remove=!1),d.active_menu[c].submenu)for(e.submenu=[],f=0;f<d.active_menu[c].submenu.length;f++)g={slug:d.active_menu[c].submenu[f].slug,remove:!1},g.position=d.active_menu[c].submenu[f].$item.index()-1,e.submenu.push(g);j.push(e)}i=d.$elements.widgets_trash.find(".postbox"),i.length&&i.each(function(){var b=d.dash_widgets[a(this).attr("id")];b&&(b.trashed=!0)}),a.post(ajaxurl,{action:"ac-save-interface",role:d.current_role,menu:j,widgets:d.dash_widgets,ac_nonce:b.nonce},function(a){switch(a.status){case"success":alert("success");break;case"fail":alert(a.error_msg)}})},exit_interface:function(a){return d.unsaved_changes&&!confirm(b.interfaceL10n.unsavedChangesExit)?(a.preventDefault(),!1):void 0},reset_interface:function(){a.post(ajaxurl,{action:"ac-reset-interface",role:d.current_role,ac_nonce:b.nonce},function(a){switch(a.status){case"success":alert("success"),window.location.reload();break;case"fail":alert(a.error_msg)}})},change_role:function(){return d.unsaved_changes&&!confirm(b.interfaceL10n.unsavedChangesChangeRole)?void a(this).val(d.current_role):void(window.location.href=window.location.pathname+"?"+a.param({ac_customize:1,ac_current_role:a(this).val()}))},disable_anchor:function(a){return a.preventDefault(),!1},reveal_cover:function(a){function b(){d.cover_timer>0&&(d.cover_timer--,setTimeout(b,100))}a="undefined"!=typeof a?a:5,d.cover_timer=a,b(),d.$elements.cover.addClass("show")},hide_cover:function(){0===d.cover_timer?d.$elements.cover.removeClass("show"):setTimeout(d.hide_cover,100)},show_widget_move_adminnotice:function(b,c){c.item.parent().hasClass("ac-interface-widgets-trash")||(d.$elements.widget_move_adminnotice.slideDown(150).effect("shake"),a("html, body").animate({scrollTop:d.$elements.widget_move_adminnotice.offset().top-(d.$elements.toolbar.length?d.$elements.toolbar.height():0)}))}};b.launch_interface&&a(c)}(jQuery,AC);
//# sourceMappingURL=admin-customizer.min.js.map