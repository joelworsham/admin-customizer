Array.prototype.move=function(a,b){if(b>=this.length)for(var c=b-this.length;c--+1;)this.push(void 0);return this.splice(b,0,this.splice(a,1)[0]),this};var AC_Interface;!function(a,b){"use strict";function c(){d.init()}var d=AC_Interface={$elements:[],active_menu:!1,current_role:null,init:function(){d.get_elements(),d.setup_handlers(),d.launch_interface()},get_elements:function(){d.$elements.adminmenu=a("#adminmenu"),d.$elements.adminmenu_trash=a(".ac-interface-adminmenu-trash"),d.$elements.widgets_toolbar=a("#ac-interface-widgets-toolbar"),d.$elements.widgets_trash=d.$elements.widgets_toolbar.find(".ac-interface-widgets-trash"),d.$elements.widgets_new=d.$elements.widgets_toolbar.find(".ac-interface-widgets-new"),d.$elements.dashwidgets=a("#dashboard-widgets").find(".meta-box-sortables"),d.$elements.toolbar=a("#ac-interface-toolbar"),d.$elements.save=d.$elements.toolbar.find("[data-ac-interface-save]"),d.$elements.reset=d.$elements.toolbar.find("[data-ac-interface-reset]"),d.$elements.select_role=d.$elements.toolbar.find("[data-ac-interface-select-role]")},setup_handlers:function(){d.$elements.save.click(d.save_interface),d.$elements.reset.click(d.reset_interface),d.$elements.select_role.change(d.change_role)},launch_interface:function(){function c(a,b){d.$elements.adminmenu_trash.removeClass("empty")}function e(a,b){d.$elements.adminmenu_trash.find("> li").length||d.$elements.adminmenu_trash.addClass("empty")}function f(a,b){b.item.addClass("closed"),d.$elements.widgets_trash.removeClass("empty"),b.sender.find(".postbox").length||(b.sender.addClass("empty-container"),b.sender.attr("data-emptyString",postBoxL10n.postBoxEmptyString))}function g(a,b){b.item.removeClass("closed"),d.$elements.widgets_trash.find("> .postbox").length||(d.$elements.widgets_trash.addClass("empty"),d.$elements.widgets_trash.attr("data-emptyString",postBoxL10n.postBoxEmptyString))}function h(a,b){b.placeholder.height(b.helper.find(".hndle").outerHeight()),b.helper.addClass("closed").height(b.helper.find(".hndle").outerHeight())}function i(a,b){b.helper&&b.helper.removeClass("closed").height("auto").width(d.$elements.dashwidgets.width())}function j(c,d){var e=d.item,f=d.item.closest(".ui-sortable"),g=e.find(".ac-widget-form"),h=e.index(),i={};g.length&&a.each(g.serializeArray(),function(a,b){i[b.name]=b.value}),i.title=e.find('[name="ac_widget_title"]').val(),c.preventDefault(),a.post(ajaxurl,{action:"ac-add-widget",widget:i,ac_nonce:b.nonce},function(a){var b,c=e.clone(!0);"success"==a.status?(e.find(".ac-widget-form-custom").html(a.form),e.find('[name="ac_widget_title"]').val(""),e.addClass("closed"),c.find(".ac-widget-inside").html(a.output),c.find(".ac-widget-title-text").html(i.title?i.title:i.widget_name),c.find(".ac-widget-form").remove(),c.find(".ac-widget-title-input").remove(),c.removeClass("closed"),b=f.find("> div.postbox:eq("+h+")"),b.length?b.before(c):f.append(c)):"fail"==a.status?a.error_msg&&alert(a.error_msg):alert("Could not complete for unknown reasons")})}d.current_role=b.current_role,d.$elements.adminmenu.find("li, a").removeClass("wp-has-current-submenu current").addClass("wp-not-current-submenu").attr("data-ac-menu-item-open","1"),a("#collapse-menu").remove(),d.active_menu=b.current_menu,d.$elements.adminmenu.find("> li").each(function(){var b=a(this).index(),c=d.active_menu[b],e=a(this).find(".wp-submenu");a(this).data("ac_active_menu_item",c),d.active_menu[b].$item=a(this),e.length&&e.find("> li").each(function(){var c,e=a(this).index();return 0===e?!0:(e-=1,c=d.active_menu[b].submenu[e],a(this).data("ac_active_submenu_item",c),void(d.active_menu[b].submenu[e].$item=a(this)))})}),d.$elements.adminmenu.find("> li").each(function(){d.active_menu[a(this).index()].remove&&a(this).appendTo(d.$elements.adminmenu_trash)}),d.$elements.adminmenu.sortable({placeholder:"ui-sortable-placeholder",axis:"y",appendTo:"parent",connectWith:".ac-interface-adminmenu-trash"}).on("click","a",d.disable_anchor).find(".wp-submenu").sortable({placeholder:"ui-sortable-placeholder",axis:"y"}),d.$elements.adminmenu_trash.sortable({placeholder:"ui-sortable-placeholder",axis:"y",connectWith:"#adminmenu",receive:c,remove:e}),d.$elements.adminmenu_trash.find("> li").length||(d.$elements.adminmenu_trash.addClass("empty"),d.$elements.adminmenu_trash.attr("data-emptyString",b.interfaceL10n.adminmenuTrashEmpty)),d.$elements.widgets_trash.sortable({containment:!1,connectWith:".meta-box-sortables",placeholder:"sortable-placeholder",receive:f,remove:g,over:h,out:i}),d.$elements.widgets_trash.find("> .postbox").length||(d.$elements.widgets_trash.addClass("empty"),d.$elements.widgets_trash.attr("data-emptyString",postBoxL10n.postBoxEmptyString)),d.$elements.widgets_trash.on("click",".hndle",function(b){a(this).closest(".postbox").addClass("closed")}),d.$elements.dashwidgets.sortable("option","connectWith",d.$elements.dashwidgets.sortable("option","connectWith")+", .ac-interface-widgets-trash"),d.$elements.widgets_new.find(".meta-box-sortables").removeClass("meta-box-sortables"),d.$elements.widgets_new.sortable({connectWith:".meta-box-sortables",placeholder:"sortable-placeholder",remove:j}),d.$elements.widgets_new.find('h2.hndle input[name$="_title"]').click(function(a){a.stopPropagation()})},save_interface:function(){var c,e,f,g,h,i=[];for(c=0;c<d.active_menu.length;c++){if(e={slug:d.active_menu[c].slug,submenu:!1},h=d.active_menu[c].$item.closest(".ac-interface-adminmenu-trash").length>0,h?(e.position=d.active_menu[c].$item.index()+d.$elements.adminmenu.find("> li").length,e.remove=!0):(e.position=d.active_menu[c].$item.index(),e.remove=!1),d.active_menu[c].submenu)for(e.submenu=[],f=0;f<d.active_menu[c].submenu.length;f++)g={slug:d.active_menu[c].submenu[f].slug,remove:!1},g.position=d.active_menu[c].submenu[f].$item.index()-1,e.submenu.push(g);i.push(e)}a.post(ajaxurl,{action:"ac-save-interface",role:d.current_role,menu:i,ac_nonce:b.nonce},function(a){switch(a.status){case"success":alert("success");break;case"fail":alert(a.error_msg)}})},reset_interface:function(){a.post(ajaxurl,{action:"ac-reset-interface",role:d.current_role,ac_nonce:b.nonce},function(a){switch(a.status){case"success":alert("success"),window.location.reload();break;case"fail":alert(a.error_msg)}})},change_role:function(){window.location.href=window.location.pathname+"?"+a.param({ac_customize:1,ac_current_role:a(this).val()})},disable_anchor:function(a){return a.preventDefault(),!1}};b.launch_interface&&a(c)}(jQuery,AC);
//# sourceMappingURL=admin-customizer.min.js.map